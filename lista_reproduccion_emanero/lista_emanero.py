temas = [
    {"Tema": "El Temblor", 
    "Fecha Lanzamiento": "2017-03-12", 
    "Vistas": "45.8 millones", 
    "Duracion": "235",
    "Link": "https://www.youtube.com/watch?v=A1B2C3D4E5"},
    
    {"Tema": "Mi Libertad",
    "Fecha Lanzamiento": "2017-07-25", 
    "Vistas": "37.4 millones", 
    "Duracion": "210", 
    "Link": "https://www.youtube.com/watch?v=F6G7H8I9J0"},
    
    {"Tema": "Tu Mejor Estudiante", 
    "Fecha Lanzamiento": "2018-05-14",
    "Vistas": "52.6 millones", 
    "Duracion": "248", "Link": "https://www.youtube.com/watch?v=K1L2M3N4O5"},
    
    {"Tema": "FMK | Estani | Rusherking - Bandido", 
    "Fecha Lanzamiento": "2022-09-10", 
    "Vistas": "64.2 millones", 
    "Duracion": "320", 
    "Link": "https://www.youtube.com/watch?v=P6Q7R8S9T0"},
    
    {"Tema": "Karina - No Me Digas que No", 
    "Fecha Lanzamiento": "2022-11-21", 
    "Vistas": "58.3 millones", 
    "Duracion": "298", 
    "Link": "https://www.youtube.com/watch?v=U1V2W3X4Y5"},
    
    {"Tema": "Mario Luis - Whisky", 
    "Fecha Lanzamiento": "2022-08-15",
    "Vistas": "41.7 millones", 
    "Duracion": "245", 
    "Link": "https://www.youtube.com/watch?v=Z6A7B8C9D0"},
    
    {"Tema": "FMK - Tu 50", 
    "Fecha Lanzamiento": "2022-06-05", 
    "Vistas": "49.9 millones", 
    "Duracion": "260", 
    "Link": "https://www.youtube.com/watch?v=E1F2G3H4I5"},
    
    {"Tema": "Tengo en Venta el Corazón", 
    "Fecha Lanzamiento": "2023-02-18", 
    "Vistas": "32.1 millones",
    "Duracion": "275", "Link": "https://www.youtube.com/watch?v=J6K7L8M9N0"},
    
    {"Tema": "Esa Morocha", 
    "Fecha Lanzamiento": "2023-04-12", 
    "Vistas": "27.5 millones", 
    "Duracion": "230", "Link": "https://www.youtube.com/watch?v=O1P2Q3R4S5"},
    
    {"Tema": "Ulises Bueno | Los Palmeras | Migrantes - Atorrante", 
    "Fecha Lanzamiento": "2023-07-19", 
    "Vistas": "78.4 millones", 
    "Duracion": "360", "Link": "https://www.youtube.com/watch?v=T6U7V8W9X0"},
    
    {"Tema": "La Konga | Antonio Ríos - Adicto", 
    "Fecha Lanzamiento": "2023-09-09", 
    "Vistas": "53.9 millones", 
    "Duracion": "310", 
    "Link": "https://www.youtube.com/watch?v=Y1Z2A3B4C5"},
    
    {"Tema": "J mena | Karina | Angela Torres - Sinvergüenza", 
    "Fecha Lanzamiento": "2023-11-22", 
    "Vistas": "60.7 millones", 
    "Duracion": "295", 
    "Link": "https://www.youtube.com/watch?v=D6E7F8G9H0"},
    
    {"Tema": "Angel López | Rusherking - A Puro Dolor", 
    "Fecha Lanzamiento": "2024-01-15", 
    "Vistas": "34.8 millones", 
    "Duracion": "305", 
    "Link": "https://www.youtube.com/watch?v=I1J2K3L4M5"},
    
    {"Tema": "BM | Mario Luis | Onda Sabanera - Ladrona", 
    "Fecha Lanzamiento": "2024-03-10", 
    "Vistas": "29.6 millones", 
    "Duracion": "280", 
    "Link": "https://www.youtube.com/watch?v=N6O7P8Q9R0"},
    
    {"Tema": "Chernobyl", 
    "Fecha Lanzamiento": "2019-06-08", 
    "Vistas": "15.2 millones", 
    "Duracion": "215", 
    "Link": "https://www.youtube.com/watch?v=S1T2U3V4W5"},
    
    {"Tema": "Pastillitas", 
    "Fecha Lanzamiento": "2020-10-30", 
    "Vistas": "18.7 millones", 
    "Duracion": "220", 
    "Link": "https://www.youtube.com/watch?v=X6Y7Z8A9B0"},
    
    {"Tema": "Como Vos Lo Haces",
    "Fecha Lanzamiento": "2021-02-13",
    "Vistas": "21.5 millones", 
    "Duracion": "265", 
    "Link": "https://www.youtube.com/watch?v=C1D2E3F4G5"},
    
    {"Tema": "Estani - Sola", 
    "Fecha Lanzamiento": "2021-08-29", 
    "Vistas": "25.3 millones", 
    "Duracion": "255", 
    "Link": "https://www.youtube.com/watch?v=H6I7J8K9L0"},
    
    {"Tema": "Rusherking - Porque Puedo", 
    "Fecha Lanzamiento": "2022-03-07", 
    "Vistas": "36.8 millones", 
    "Duracion": "310", 
    "Link": "https://www.youtube.com/watch?v=M1N2O3P4Q5"},
    
    {"Tema": "Quien es Quien", 
    "Fecha Lanzamiento": "2022-12-12", 
    "Vistas": "33.9 millones", 
    "Duracion": "245", 
    "Link": "https://www.youtube.com/watch?v=R6S7T8U9V0"},
    
    {"Tema": "La Konga | Karina - Manicomio",
    "Fecha Lanzamiento": "2023-05-17",
    "Vistas": "40.4 millones", 
    "Duracion": "295", 
    "Link": "https://www.youtube.com/watch?v=W1X2Y3Z4A5"},
    
    {"Tema": "Karina | Angela - WTF", 
    "Fecha Lanzamiento": "2023-10-05", 
    "Vistas": "23.0 millones", 
    "Duracion": "225", 
    "Link": "https://www.youtube.com/watch?v=B6C7D8E9F0"}
]

from lista_reproduccion import *
import copy

def ordenar_temas(lista_temas:list)->list:
    """los temas se ordenarán por duración, de mayor a menor."""
    lista_a_ordenar = copy.copy(lista_temas)
    for i in range(len(lista_a_ordenar)-1):
        for j in range(i+1, len(lista_a_ordenar)):
            if lista_a_ordenar[i]["Duracion"] > lista_a_ordenar[j]["Duracion"]:
                aux = lista_a_ordenar[i]
                lista_a_ordenar[i]=  lista_a_ordenar[j]
                lista_a_ordenar[j] = aux
    return lista_a_ordenar
    
def promedio_de_vistas(lista_canciones:list)->int:
    visualizaciones = 0
    contador_temas = 0
    for elemento in lista_canciones:
        visitas = convertir_vistas_numerico(elemento["Vistas"])
        visualizaciones += visitas
        contador_temas += 1
    promedio = visualizaciones / contador_temas
    promedio_en_k = promedio /1_000
    return promedio_en_k

def maxima_reproduccion(lista_temas:list):
    maxima_visualizacion = 0
    nombre_tema = ""
    bandera = True
    cancion_mas_vista = []
    
    for tema in lista_temas:
        visitas = convertir_vistas_numerico(tema["Vistas"])
        cancion = obtener_nombre_tema(tema["Tema"])
        if visitas > maxima_visualizacion or bandera:
            maxima_visualizacion = visitas
            nombre_tema = cancion
            bandera = False
    cancion_mas_vista.append(maxima_visualizacion)
    cancion_mas_vista.append(nombre_tema)
    
    return cancion_mas_vista


def minimo_reproduccion(lista_temas:list):
    minima_visualizacion = 0
    nombre_tema = ""
    bandera = True
    cancion_menos_vista = []
    
    for tema in lista_temas:
        visitas = convertir_vistas_numerico(tema["Vistas"])
        cancion = obtener_nombre_tema(tema["Tema"])
        if visitas < minima_visualizacion or bandera:
            minima_visualizacion = visitas
            nombre_tema = cancion
            bandera = False
    cancion_menos_vista.append(minima_visualizacion)
    cancion_menos_vista.append(nombre_tema)
    
    return cancion_menos_vista


def busqueda_por_codigo(lista_temas:list):
    url = input("Ingrese el código del tema: ")
    encontrado = False
    for codigo in lista_temas:
        link = obtener_codigo(codigo["Link"])
        if url == link:
            print(f"""Cancion: {obtener_nombre_tema(codigo["Tema"])} - Colaboradores: {obtener_colaboradores(codigo["Tema"])}
Vistas: {convertir_vistas_numerico(codigo["Vistas"])} - Duracion: {convertir_duracion_numerico(codigo["Duracion"])}
Fecha lanzamiento: {formatear_fecha(codigo["Fecha Lanzamiento"])}""")
            encontrado = True
    if encontrado == False:
        print("No se encontro el codigo")
        
def listar_por_colaborador(lista_temas:list):
    colaborador = input("Ingrese el nombre del cantante: ").title()
    encontrado = False  
    for cantante in lista_temas:
        integrantes = obtener_colaboradores(cantante["Tema"])
        for integrante in integrantes:
            if colaborador == integrante.strip():
                print(obtener_nombre_tema(cantante["Tema"]))
                encontrado = True
                break
    if encontrado == False:
        print("No se encontro el cantante")
        
def listar_por_mes(lista_temas:list):
    mes_canciones = int(input("Ingrese un mes: "))
    while 0 <= mes_canciones > 12:
            mes_canciones = int(input("Reingrese un mes: "))
    
    for fecha in lista_temas:
        fechas = formatear_fecha(fecha["Fecha Lanzamiento"])
        
        if mes_canciones == fechas.month:
            print(obtener_nombre_tema(fecha["Tema"]))
            encontrado = True
                
    if encontrado == False:
        print("No se encontraron temas de ese mes") 

menu = True
datos_normalizados = False

while menu:
    opcion = input("""Menú
A. NORMALIZAR DATOS.
B. MOSTRAR TEMAS.
C. ORDENAR TEMAS.
D. PROMEDIO DE VISTAS.
E. MÁXIMA REPRODUCCIÓN.
F. MÍNIMA REPRODUCCIÓN. 
G. BÚSQUEDA POR CÓDIGO.
H. LISTAR POR COLABORADOR.
I. LISTAR POR MES.
J. SALIR. 
Elija una opcion: """)
    match opcion.upper():
        case "A":
            for elemento in temas:
                print(obtener_colaboradores(elemento["Tema"]))
                print(obtener_nombre_tema(elemento["Tema"]))
                print(convertir_vistas_numerico(elemento["Vistas"]))
                print(convertir_duracion_numerico(elemento["Duracion"]))
                print(obtener_codigo(elemento["Link"]))
                print(formatear_fecha(elemento["Fecha Lanzamiento"]))
                print("-"*20)
                datos_normalizados = True 
                
        case "B":
            print("-"*20)
            if datos_normalizados:
                for cancion in temas:
                    print(obtener_nombre_tema(cancion["Tema"]))  
            else:
                print("Primero debe normalizar los datos (item A)") 
            print("-"*20)
        case"C":
            print("-"*20)       
            if datos_normalizados:
                canciones_ordenadas = ordenar_temas(temas)
                for cancion in canciones_ordenadas:
                    print(f"cancion: {obtener_nombre_tema(cancion["Tema"])} - Duracion: {cancion['Duracion']}")
            else:
                print("Primero debe normalizar los datos (item A)") 
                print("-"*20)       
        case "D":
            print("-"*20)
            if datos_normalizados:
                print(f"Un promedio de {promedio_de_vistas(temas):.2f}k vistas")  
            else:
                print("Primero debe normalizar los datos (item A)") 
            print("-"*20)
        case "E":
            print("-"*20)
            if datos_normalizados:
                reproducciones =maxima_reproduccion(temas)
                print(f"La cancion {reproducciones[1]} es la que tiene mayor cantidad de reproducciones con un valor de {reproducciones[0]} millones de vistas")
            else:
                print("Primero debe normalizar los datos (item A)") 
            print("-"*20)
        case "F":
            print("-"*20)
            if datos_normalizados:
                reproducciones = minimo_reproduccion(temas)
                print(f"La cancion {reproducciones[1]} es la que tiene menor cantidad de reproducciones con un valor de {reproducciones[0]} millones de vistas")
            else:
                print("Primero debe normalizar los datos (item A)") 
            print("-"*20)
        case "G":
            print("-"*20)
            if datos_normalizados:
                busqueda_por_codigo(temas)
            else:
                print("Primero debe normalizar los datos (item A)") 
            print("-"*20)
        case "H":
            print("-"*20)
            if datos_normalizados:
                listar_por_colaborador(temas)
            else:
                print("Primero debe normalizar los datos (item A)") 
            print("-"*20)
        case "I":
            if datos_normalizados:
                listar_por_mes(temas)
            else:
                print("Primero debe normalizar los datos (item A)") 
            print("-"*20)
        case "J":
            print("-"*20)
            print("Saliendo del programa...")
            menu = False
            print("-"*20)
        case _:
            print("-"*20)
            print("Opción inválida. Reingrese")
            print("-"*20)

